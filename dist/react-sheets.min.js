!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["react","react-dom"],t):"object"==typeof exports?exports.ReactSheets=t(require("react"),require("react-dom")):e.ReactSheets=t(e.React,e.ReactDOM)}(this,function(e,t){return function(e){function t(n){if(l[n])return l[n].exports;var s=l[n]={exports:{},id:n,loaded:!1};return e[n].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var l={};return t.m=e,t.c=l,t.p="",t(0)}([function(e,t,l){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=l(7),a=n(s);t.default=a.default},function(e,t){"use strict";var l={firstInArray:function(e,t,l){var n=null;return e.some(function(s,a){return!!t.call(l,s,a,e)&&(n=s,!0)}),n},firstTDinArray:function(e){var t=l.firstInArray(e,function(e){return!(!e.nodeName||"TD"!==e.nodeName)});return t},equalCells:function(e,t){return!(!e||!t||e.length!==t.length)&&(e[0]===t[0]&&e[1]===t[1])},countWithLetters:function(e){var t=e%26,l=e/26|0,n=t?String.fromCharCode(64+t):(--l,"Z");return l?this.countWithLetters(l)+n:n}};e.exports=l},function(t,l){t.exports=e},function(e,t){"use strict";var l="KILL ME",n={topics:{},subscribe:function(e,t){this.topics[l]||(this.topics[l]=[]),this.topics[l][e]||(this.topics[l][e]=[]),this.topics[l][e].push(t)},publish:function(e,t){this.topics[l]&&this.topics[l][e]&&this.topics[l][e].length>=1&&this.topics[l][e].forEach(function(e){e(t||{})})}};e.exports=n},function(e,t){e.exports={sheet:"sheet__sheet___wUrHo",td:"sheet__td___3dyyT",selected:"sheet__selected___2VDVk",th:"sheet__th___19IEk"}},function(e,t,l){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var s=l(2),a=n(s),i=l(3),r=n(i),o=l(1),u=n(o),d=l(4),c=n(d),h=a.default.createClass({displayName:"CellComponent",getInitialState:function(){return{editing:this.props.editing,changedValue:this.props.value}},render:function(){var e,t=this,l=this.props,n=l.selected?c.default.selected:"",s=l.config||{emptyValueSymbol:""},i=""!==l.value&&l.value?l.value:s.emptyValueSymbol,r=l.cellClasses&&l.cellClasses.length>0?l.cellClasses+" "+n:n,o=this.renderHeader();return o?o:(l.selected&&l.editing&&(e=a.default.createElement("input",{className:"mousetrap",onChange:this.handleChange,onBlur:this.handleBlur,onKeyDown:function(e){return t.handleKeyDown(e)},ref:function(e){return t.editInput=e},defaultValue:this.props.value})),a.default.createElement("td",{className:c.default.td+" "+r},a.default.createElement("div",{className:"reactTableCell"},e,a.default.createElement("span",{onDoubleClick:this.handleDoubleClick,onClick:this.handleClick},i))))},componentDidUpdate:function(e,t){this.editInput&&this.props.editing&&this.props.selected&&(this.editInput.focus(),e.editing||this.editInput.select()),e.selected&&e.editing&&this.state.changedValue!==this.props.value&&this.props.onCellValueChange(this.props.uid,this.state.changedValue)},handleClick:function(e){this.props.handleSelectCell(this.props.uid)},handleHeadClick:function(e){r.default.publish("headCellClicked",this.props.uid)},handleDoubleClick:function(e){e.preventDefault(),this.props.handleDoubleClickOnCell(this.props.uid)},handleBlur:function(e){var t=e.target.value;this.props.onCellValueChange(this.props.uid,t,e),this.props.handleCellBlur(this.props.uid),r.default.publish("cellBlurred",this.props.uid)},handleChange:function(e){var t=e.target.value;this.setState({changedValue:t})},handleKeyDown:function(e){console.log("keydown",e.which,e.keyCode),[32,37,38,39,40].includes(e.which)&&e.stopPropagation()},renderHeader:function(){var e=this.props,t=e.selected?"selected":"",l=e.uid,n=e.config||{emptyValueSymbol:""},s=""!==e.value&&e.value?e.value:n.emptyValueSymbol,i=e.cellClasses&&e.cellClasses.length>0?this.props.cellClasses+" "+t:t,r=0===l[0],o=0===l[1],d=n.hasHeadRow&&0===l[0],h=n.hasHeadColumn&&0===l[1];return!(!d&&!h)&&(o&&n.hasLetterNumberHeads?s=l[0]:r&&n.hasLetterNumberHeads&&(s=u.default.countWithLetters(l[1])),n.isHeadRowString&&r||n.isHeadColumnString&&o?a.default.createElement("th",{className:c.default.th+" "+c.default.td+i},a.default.createElement("div",null,a.default.createElement("span",{onClick:this.handleHeadClick},s))):a.default.createElement("th",null,s))}});e.exports=h},function(e,t,l){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=l(2),a=n(s),i=l(5),r=n(i),o=l(1),u=n(o),d=function(e){var t=e.config,l=e.cells,n=e.cellClasses,s=e.selected,i=e.editing,o=e.uid;if(!t.columns||0===l.length)return console.error("Table can't be initialized without set number of columns and no data!");var d=l.map(function(d,c){var h=[o,c],f=u.default.equalCells(s,h),p=n&&n[c]?(void 0).props.cellClasses[c]:"";return a.default.createElement(r.default,{key:"row_"+o+"_cell_"+c,uid:h,value:l[c],config:t,cellClasses:p,onCellValueChange:e.onCellValueChange,handleSelectCell:e.handleSelectCell,handleDoubleClickOnCell:e.handleDoubleClickOnCell,handleCellBlur:e.handleCellBlur,selected:f,editing:i})});return a.default.createElement("tr",null,d)};t.default=d},function(e,t,l){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var s=l(2),a=n(s),i=l(8),r=(n(i),l(6)),o=n(r),u=l(3),d=n(u),c=l(1),h=n(c),f=l(4),p=n(f),C=a.default.createClass({displayName:"Sheet",getInitialState:function(){var e=this.props.initialData||{};if(!e.rows){e.rows=[];for(var t=0;this.props.config.rows>t;t+=1){e.rows[t]=[];for(var l=0;this.props.config.columns>l;l+=1)e.rows[t][l]=""}}return{data:e,selected:null,lastBlurred:null,editing:!1}},render:function(){var e,t,l,n=this,s=this.state.data,i=this.props.config,r=this.props.cellClasses,u=[];if(!s.rows&&!i.rows)return console.error("Table Component: Number of colums not defined in both data and config!");for(t=0;s.rows.length>t;t+=1)e="row_"+t,l=r&&r.rows&&r.rows[t]?r.rows[t]:null,u.push(a.default.createElement(o.default,{cells:s.rows[t],cellClasses:l,uid:t,key:e,config:i,selected:this.state.selected,editing:this.state.editing,handleSelectCell:this.handleSelectCell,handleDoubleClickOnCell:this.handleDoubleClickOnCell,handleCellBlur:this.handleCellBlur,onCellValueChange:this.handleCellValueChange,className:"cellComponent"}));return a.default.createElement("table",{className:p.default.sheet,tabIndex:"0",ref:function(e){return n.table=e},onKeyDown:function(e){return n._handleKeyDown(e)},onKeyUp:function(e){return n._handleKeyUp(e)},onKeyPress:function(e){return n._handleKeyPress(e)}},a.default.createElement("tbody",null,u))},_handleKeyDown:function(e){console.log("keydown",e.keyCode,e.target.tagName),!this.state.editing&&[32,37,38,39,40].includes(e.keyCode)?e.preventDefault():9===e.keyCode?e.preventDefault():!this.state.editing&&[46,8].includes(e.keyCode)&&e.preventDefault()},_handleKeyUp:function(e){console.log("keyup",e.keyCode,e.target.tagName),[9,37,38,39,40].includes(e.keyCode)?(e.preventDefault(),this.navigateTable(e.keyCode)):!this.state.editing&&[46,8].includes(e.keyCode)&&this.state.selected&&!h.default.equalCells(this.state.selected,this.state.lastBlurred)&&this.handleCellValueChange(this.state.selected,"")},_handleKeyPress:function(e){console.log("keypress",e.key,!(e.altKey||e.ctrlKey||e.metaKey),/^[^\p{C}\p{Z}]*$/.test(e.key)),this.state.selected&&(this.state.editing?/^(Enter|Return)$/.test(e.key)&&(this.setState({editing:!1}),this.table.focus()):/^[^\p{C}\p{Z}]*$/.test(e.key)&&(d.default.publish("editStarted",this.state.selected),this.setState({editing:!0})))},navigateTable:function(e){if(!this.state.editing){var t=this.props.config,l=[this.state.selected[0],this.state.selected[1]],n=this.state.data.rows,s=t.canAddRow?n.length:n.length-1,a=t.canAddColumn?n[0].length:n[0].length-1;switch(e){case"up":case 38:l[0]=Math.max(1,l[0]-1);break;case"down":case 40:l[0]=Math.min(s,l[0]+1);break;case"left":case 37:l[1]=Math.max(1,l[1]-1);break;case"right":case 39:l[1]=Math.min(a,l[1]+1);break;case 9:l[1]===n[0].length-1?l[0]===n.length-1&&t.canAddRow&&(l[0]=n.length,l[1]=1):l[1]+=1}n.length!==l[0]&&n[0].length!==l[1]||this.extendTable(e),this.handleSelectCell(l)}},extendTable:function(e){var t,l,n=this.props.config,s=this.state.data;if(("down"===e||40===e||9===e)&&n.canAddRow){for(t=[],l=0;this.state.data.rows[0].length>l;l+=1)t[l]="";return s.rows.push(t),d.default.publish("rowCreated",s.rows.length),this.setState({data:s})}if(n.canAddColumn){for(l=0;s.rows.length>l;l+=1)s.rows[l].push("");return d.default.publish("columnCreated",s.rows[0].length),this.setState({data:s})}},handleSelectCell:function(e){d.default.publish("cellSelected",e),this.table.focus(),this.setState({selected:e})},handleCellValueChange:function(e,t){var l=this.state.data,n=e[0],s=e[1],a=l.rows[n][s];d.default.publish("cellValueChanged",[e,t,a]),l.rows[n][s]=t,this.setState({data:l}),d.default.publish("dataChanged",l)},handleDoubleClickOnCell:function(){this.setState({editing:!0})},handleCellBlur:function(e){this.state.editing&&d.default.publish("editStopped",e),this.setState({editing:!1,lastBlurred:e})}});e.exports=C},function(e,l){e.exports=t}])});